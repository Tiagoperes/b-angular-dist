import { findById } from 'beagle-web/dist/utils/tree-reading';
const views = {};
function createContext(view, elementId) {
    return {
        replace: params => view.updateWithFetch(params, elementId, 'replace'),
        append: params => view.updateWithFetch(params, elementId, 'append'),
        prepend: params => view.updateWithFetch(params, elementId, 'prepend'),
        updateWithTree: params => view.updateWithTree(Object.assign(Object.assign({}, params), { elementId })),
        getElementId: () => elementId,
        getElement: () => findById(view.getTree(), elementId),
        getView: () => view
    };
}
export function getContext(viewId, elementId) {
    if (!viewId || !elementId)
        throw Error('Beagle: getContext couldn\'t find viewId or elementId');
    const view = views[viewId];
    if (!view)
        throw Error(`Beagle: getContext couldn\'t find view with id ${viewId}`);
    return createContext(view, elementId);
}
export function registerView(viewId, view) {
    views[viewId] = view;
}
export function unregisterView(viewId) {
    delete views[viewId];
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29udGV4dC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL2JlYWdsZS1hbmd1bGFyLyIsInNvdXJjZXMiOlsiYmVhZ2xlLWNvbnRleHQvY29udGV4dC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDQSxPQUFPLEVBQUUsUUFBUSxFQUFFLE1BQU0sb0NBQW9DLENBQUE7QUFHN0QsTUFBTSxLQUFLLEdBQStCLEVBQUUsQ0FBQTtBQUU1QyxTQUFTLGFBQWEsQ0FBSSxJQUFtQixFQUFFLFNBQWlCO0lBQzlELE9BQU87UUFDTCxPQUFPLEVBQUUsTUFBTSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDLE1BQU0sRUFBRSxTQUFTLEVBQUUsU0FBUyxDQUFDO1FBQ3JFLE1BQU0sRUFBRSxNQUFNLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxlQUFlLENBQUMsTUFBTSxFQUFFLFNBQVMsRUFBRSxRQUFRLENBQUM7UUFDbkUsT0FBTyxFQUFFLE1BQU0sQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxNQUFNLEVBQUUsU0FBUyxFQUFFLFNBQVMsQ0FBQztRQUNyRSxjQUFjLEVBQUUsTUFBTSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsY0FBYyxpQ0FBTSxNQUFNLEtBQUUsU0FBUyxJQUFHO1FBQ3ZFLFlBQVksRUFBRSxHQUFHLEVBQUUsQ0FBQyxTQUFTO1FBQzdCLFVBQVUsRUFBRSxHQUFHLEVBQUUsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxFQUFFLFNBQVMsQ0FBQztRQUNyRCxPQUFPLEVBQUUsR0FBRyxFQUFFLENBQUMsSUFBSTtLQUNwQixDQUFBO0FBQ0gsQ0FBQztBQUVELE1BQU0sVUFBVSxVQUFVLENBQUMsTUFBYyxFQUFFLFNBQWlCO0lBQzFELElBQUksQ0FBQyxNQUFNLElBQUksQ0FBQyxTQUFTO1FBQUUsTUFBTSxLQUFLLENBQUMsdURBQXVELENBQUMsQ0FBQTtJQUUvRixNQUFNLElBQUksR0FBRyxLQUFLLENBQUMsTUFBTSxDQUFDLENBQUE7SUFDMUIsSUFBSSxDQUFDLElBQUk7UUFBRSxNQUFNLEtBQUssQ0FBQyxrREFBa0QsTUFBTSxFQUFFLENBQUMsQ0FBQTtJQUVsRixPQUFPLGFBQWEsQ0FBQyxJQUFJLEVBQUUsU0FBUyxDQUFDLENBQUE7QUFDdkMsQ0FBQztBQUVELE1BQU0sVUFBVSxZQUFZLENBQUMsTUFBTSxFQUFFLElBQWdCO0lBQ25ELEtBQUssQ0FBQyxNQUFNLENBQUMsR0FBRyxJQUFJLENBQUE7QUFDdEIsQ0FBQztBQUVELE1BQU0sVUFBVSxjQUFjLENBQUMsTUFBTTtJQUNuQyxPQUFPLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQTtBQUN0QixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQmVhZ2xlVmlldyB9IGZyb20gJ2JlYWdsZS13ZWInXG5pbXBvcnQgeyBmaW5kQnlJZCB9IGZyb20gJ2JlYWdsZS13ZWIvZGlzdC91dGlscy90cmVlLXJlYWRpbmcnXG5pbXBvcnQgeyBCZWFnbGVDb250ZXh0IH0gZnJvbSAnLi4vdHlwZXMnXG5cbmNvbnN0IHZpZXdzOiBSZWNvcmQ8c3RyaW5nLCBCZWFnbGVWaWV3PiA9IHt9XG5cbmZ1bmN0aW9uIGNyZWF0ZUNvbnRleHQ8VD4odmlldzogQmVhZ2xlVmlldzxUPiwgZWxlbWVudElkOiBzdHJpbmcpOiBCZWFnbGVDb250ZXh0PFQ+IHtcbiAgcmV0dXJuIHtcbiAgICByZXBsYWNlOiBwYXJhbXMgPT4gdmlldy51cGRhdGVXaXRoRmV0Y2gocGFyYW1zLCBlbGVtZW50SWQsICdyZXBsYWNlJyksXG4gICAgYXBwZW5kOiBwYXJhbXMgPT4gdmlldy51cGRhdGVXaXRoRmV0Y2gocGFyYW1zLCBlbGVtZW50SWQsICdhcHBlbmQnKSxcbiAgICBwcmVwZW5kOiBwYXJhbXMgPT4gdmlldy51cGRhdGVXaXRoRmV0Y2gocGFyYW1zLCBlbGVtZW50SWQsICdwcmVwZW5kJyksXG4gICAgdXBkYXRlV2l0aFRyZWU6IHBhcmFtcyA9PiB2aWV3LnVwZGF0ZVdpdGhUcmVlKHsgLi4ucGFyYW1zLCBlbGVtZW50SWQgfSksXG4gICAgZ2V0RWxlbWVudElkOiAoKSA9PiBlbGVtZW50SWQsXG4gICAgZ2V0RWxlbWVudDogKCkgPT4gZmluZEJ5SWQodmlldy5nZXRUcmVlKCksIGVsZW1lbnRJZCksXG4gICAgZ2V0VmlldzogKCkgPT4gdmlld1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRDb250ZXh0KHZpZXdJZDogc3RyaW5nLCBlbGVtZW50SWQ6IHN0cmluZykge1xuICBpZiAoIXZpZXdJZCB8fCAhZWxlbWVudElkKSB0aHJvdyBFcnJvcignQmVhZ2xlOiBnZXRDb250ZXh0IGNvdWxkblxcJ3QgZmluZCB2aWV3SWQgb3IgZWxlbWVudElkJylcblxuICBjb25zdCB2aWV3ID0gdmlld3Nbdmlld0lkXVxuICBpZiAoIXZpZXcpIHRocm93IEVycm9yKGBCZWFnbGU6IGdldENvbnRleHQgY291bGRuXFwndCBmaW5kIHZpZXcgd2l0aCBpZCAke3ZpZXdJZH1gKVxuXG4gIHJldHVybiBjcmVhdGVDb250ZXh0KHZpZXcsIGVsZW1lbnRJZClcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlZ2lzdGVyVmlldyh2aWV3SWQsIHZpZXc6IEJlYWdsZVZpZXcpIHtcbiAgdmlld3Nbdmlld0lkXSA9IHZpZXdcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVucmVnaXN0ZXJWaWV3KHZpZXdJZCkge1xuICBkZWxldGUgdmlld3Nbdmlld0lkXVxufVxuIl19